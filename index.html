<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>نظام توليد أسئلة ذكي - بدون باك اند</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cairo&display=swap');
  body {
    margin: 0; padding: 0; font-family: 'Cairo', sans-serif;
    background: linear-gradient(135deg, #1f2937, #4f46e5);
    color: #fff; display: flex; flex-direction: column; align-items: center; min-height: 100vh;
  }
  header {
    margin: 20px 0;
    font-size: 2.5rem;
    font-weight: 700;
    text-shadow: 0 0 10px #6366f1;
  }
  main {
    background: rgba(255 255 255 / 0.1);
    padding: 25px 40px;
    border-radius: 20px;
    width: 90%;
    max-width: 600px;
    box-shadow: 0 0 20px #4f46e5aa;
    user-select: none;
  }
  .question {
    font-size: 1.5rem;
    margin-bottom: 20px;
    min-height: 80px;
  }
  .answers {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  button.answer-btn {
    background: #6366f1;
    border: none;
    padding: 15px;
    font-size: 1.2rem;
    border-radius: 12px;
    cursor: pointer;
    color: white;
    box-shadow: 0 4px 15px #818cf8cc;
    transition: background 0.3s ease;
  }
  button.answer-btn:hover {
    background: #4f46e5;
  }
  button.correct {
    background: #22c55e !important;
    box-shadow: 0 0 15px #22c55eaa;
  }
  button.wrong {
    background: #ef4444 !important;
    box-shadow: 0 0 15px #ef4444aa;
  }
  .scoreboard {
    margin-top: 25px;
    font-size: 1.2rem;
    background: rgba(255 255 255 / 0.15);
    padding: 10px 20px;
    border-radius: 12px;
    text-align: center;
    user-select: none;
  }
  footer {
    margin-top: auto;
    padding: 15px;
    font-size: 0.9rem;
    color: #a5b4fc;
    user-select: none;
  }
</style>
</head>
<body>
<header>تحدي الذكاء الذكي</header>
<main>
  <div class="question" id="question">جارٍ تحميل السؤال...</div>
  <div class="answers" id="answers"></div>
  <div class="scoreboard" id="scoreboard">الدرجة: 0 | مستوى الصعوبة: 1</div>
</main>
<footer>يوسف - نموذج توليد أسئلة بدون باك اند</footer>

<script>
(() => {
  // حالة اللعبة
  let score = 0;
  let difficulty = 1;
  let askedQuestions = new Set();

  // مولد أسئلة ديناميكي بحسب الصعوبة
  function generateQuestion(difficulty) {
    // أنواع الأسئلة: اختيار متعدد، صح أو خطأ، أكمل الفراغ، حسابي
    const types = ['multipleChoice', 'trueFalse', 'fillBlank', 'math'];
    const type = types[Math.floor(Math.random() * types.length)];

    // مفردات وأسئلة بناءً على النوع والصعوبة
    switch(type) {
      case 'multipleChoice':
        return generateMultipleChoice(difficulty);
      case 'trueFalse':
        return generateTrueFalse(difficulty);
      case 'fillBlank':
        return generateFillBlank(difficulty);
      case 'math':
        return generateMath(difficulty);
    }
  }

  function generateMultipleChoice(diff) {
    const easyQs = [
      {q: "ما هي عاصمة مصر؟", a: "القاهرة", options: ["القاهرة", "الإسكندرية", "الرياض", "دمشق"]},
      {q: "ما لون السماء؟", a: "أزرق", options: ["أحمر", "أزرق", "أصفر", "أخضر"]},
      {q: "ما هو أكبر كوكب في المجموعة الشمسية؟", a: "المشتري", options: ["المريخ", "الأرض", "المشتري", "الزهرة"]}
    ];
    const medQs = [
      {q: "من هو مؤسس شركة مايكروسوفت؟", a: "بيل جيتس", options: ["بيل جيتس", "ستيف جوبز", "مارك زوكربيرغ", "إيلون ماسك"]},
      {q: "أي من هذه الحيوانات يعيش في الماء فقط؟", a: "الدلفين", options: ["التمساح", "الدلفين", "الضبع", "النسور"]},
      {q: "ما هو الغاز الذي نتنفسه؟", a: "الأكسجين", options: ["النيتروجين", "الهيدروجين", "الأكسجين", "الكربون"]},
    ];
    const hardQs = [
      {q: "ما هو العنصر الكيميائي الذي رمزه Fe؟", a: "الحديد", options: ["الذهب", "الحديد", "الفوسفور", "الزنك"]},
      {q: "في أي سنة وقعت الثورة الفرنسية؟", a: "1789", options: ["1776", "1789", "1812", "1804"]},
      {q: "من هو الفيلسوف الذي قال: 'أنا أفكر إذن أنا موجود'؟", a: "ديكارت", options: ["أفلاطون", "أرسطو", "ديكارت", "هيجل"]},
    ];
    let pool;
    if(diff <= 2) pool = easyQs;
    else if(diff <= 4) pool = medQs;
    else pool = hardQs;

    // اختيار سؤال عشوائي بدون تكرار
    let question;
    do {
      question = pool[Math.floor(Math.random() * pool.length)];
    } while(askedQuestions.has(question.q) && askedQuestions.size < pool.length);

    askedQuestions.add(question.q);
    return {type: 'multipleChoice', ...question};
  }

  function generateTrueFalse(diff) {
    const easyTF = [
      {q: "الشمس هي نجم.", a: true},
      {q: "القمر أكبر من الأرض.", a: false},
      {q: "الماء يغلي عند 100 درجة مئوية.", a: true},
    ];
    const medTF = [
      {q: "الكرة الأرضية مسطحة.", a: false},
      {q: "الذرة تتكون من إلكترونات وبروتونات.", a: true},
      {q: "الأكسجين هو الغاز الوحيد الذي نتنفسه.", a: false},
    ];
    const hardTF = [
      {q: "النسبية العامة هي نظرية فيزيائية قدمها أينشتاين.", a: true},
      {q: "الصخور النارية تتكون من صهارة باردة.", a: false},
      {q: "فيزياء الكم لا تتعامل مع الجسيمات الصغيرة فقط.", a: true},
    ];
    let pool;
    if(diff <= 2) pool = easyTF;
    else if(diff <=4) pool = medTF;
    else pool = hardTF;

    let question;
    do {
      question = pool[Math.floor(Math.random() * pool.length)];
    } while(askedQuestions.has(question.q) && askedQuestions.size < pool.length);

    askedQuestions.add(question.q);
    return {type:'trueFalse', question: question.q, answer: question.a};
  }

  function generateFillBlank(diff) {
    const easyFB = [
      {q: "العاصمة المصرية هي _____.", a: "القاهرة"},
      {q: "اللون الناتج عن خلط الأحمر والأزرق هو _____.", a: "البنفسجي"},
      {q: "الماء يغلي عند _____ درجة مئوية.", a: "100"},
    ];
    const medFB = [
      {q: "أكبر محيط في العالم هو _____.", a: "المحيط الهادئ"},
      {q: "شخصية قصة ألف ليلة وليلة الشهيرة هي _____.", a: "شهرزاد"},
      {q: "أول رئيس لمصر بعد الثورة هو _____.", a: "جمال عبد الناصر"},
    ];
    const hardFB = [
      {q: "قانون نيوتن الثالث يتعلق بـ _____ والحركة.", a: "القوة"},
      {q: "في اللغة الإنجليزية، 'cat' تعني _____.", a: "قطة"},
      {q: "عدد الكواكب في النظام الشمسي هو _____.", a: "ثمانية"},
    ];
    let pool;
    if(diff <= 2) pool = easyFB;
    else if(diff <=4) pool = medFB;
    else pool = hardFB;

    let question;
    do {
      question = pool[Math.floor(Math.random() * pool.length)];
    } while(askedQuestions.has(question.q) && askedQuestions.size < pool.length);

    askedQuestions.add(question.q);
    return {type: 'fillBlank', question: question.q, answer: question.a};
  }

  function generateMath(diff) {
    // كلما زادت الصعوبة تزيد الأرقام والعمليات
    let a = Math.floor(Math.random() * (5 * diff) + 1);
    let b = Math.floor(Math.random() * (5 * diff) + 1);
    let ops = ['+', '-', '*'];
    let op = ops[Math.floor(Math.random() * ops.length)];
    let question, answer;

    switch(op) {
      case '+':
        question = `${a} + ${b} = ?`;
        answer = a + b;
        break;
      case '-':
        question = `${a} - ${b} = ?`;
        answer = a - b;
        break;
      case '*':
        question = `${a} × ${b} = ?`;
        answer = a * b;
        break;
    }

    // تأكد من عدم التكرار بناءً على السؤال النصي
    if(askedQuestions.has(question) && askedQuestions.size < 50) {
      return generateMath(diff); // جرب مرة ثانية
    }
    askedQuestions.add(question);
    return {type: 'math', question, answer: answer.toString()};
  }

  // عرض السؤال مع خيارات أو حقل إدخال
  function displayQuestion(qObj) {
    const questionEl = document.getElementById('question');
    const answersEl = document.getElementById('answers');
    answersEl.innerHTML = '';
    questionEl.textContent = qObj.q || qObj.question;

    if(qObj.type === 'multipleChoice') {
      let shuffledOptions = qObj.options.slice().sort(() => Math.random() - 0.5);
      shuffledOptions.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(qObj.a, opt);
        answersEl.appendChild(btn);
      });
    } else if(qObj.type === 'trueFalse') {
      ['صح', 'خطأ'].forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = opt;
        btn.onclick = () => {
          let userAns = (opt === 'صح');
          checkAnswer(qObj.answer, userAns);
        };
        answersEl.appendChild(btn);
      });
    } else if(qObj.type === 'fillBlank') {
      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = 'اكتب الإجابة هنا';
      input.style.fontSize = '1.3rem';
      input.style.padding = '10px';
      input.style.borderRadius = '10px';
      input.style.border = 'none';
      input.style.marginBottom = '10px';
      input.style.width = '100%';
      answersEl.appendChild(input);

      const submitBtn = document.createElement('button');
      submitBtn.className = 'answer-btn';
      submitBtn.textContent = 'تأكيد';
      submitBtn.onclick = () => {
        let userAns = input.value.trim();
        if(userAns === '') return alert('الرجاء كتابة الإجابة');
        checkAnswer(qObj.answer, userAns);
      };
      answersEl.appendChild(submitBtn);

      input.focus();
    } else if(qObj.type === 'math') {
      const input = document.createElement('input');
      input.type = 'number';
      input.placeholder = 'اكتب الإجابة الرقمية هنا';
      input.style.fontSize = '1.3rem';
      input.style.padding = '10px';
      input.style.borderRadius = '10px';
      input.style.border = 'none';
      input.style.marginBottom = '10px';
      input.style.width = '100%';
      answersEl.appendChild(input);

      const submitBtn = document.createElement('button');
      submitBtn.className = 'answer-btn';
      submitBtn.textContent = 'تأكيد';
      submitBtn.onclick = () => {
        let userAns = input.value.trim();
        if(userAns === '') return alert('الرجاء كتابة الإجابة');
        checkAnswer(qObj.answer, userAns);
      };
      answersEl.appendChild(submitBtn);

      input.focus();
    }
  }

  // تحقق من الإجابة وحدث النتيجة
  function checkAnswer(correct, user) {
    const buttons = document.querySelectorAll('.answer-btn');
    buttons.forEach(btn => btn.disabled = true);

    let isCorrect = false;
    if(typeof correct === 'boolean') {
      isCorrect = (correct === user);
    } else {
      // مقارنة نصية غير حساسة لحالة الأحرف والمسافات الزائدة
      isCorrect = correct.toString().trim().toLowerCase() === user.toString().trim().toLowerCase();
    }

    // تعليم الأزرار
    buttons.forEach(btn => {
      if(btn.textContent.trim().toLowerCase() === correct.toString().trim().toLowerCase()) {
        btn.classList.add('correct');
      } else if(btn.textContent.trim().toLowerCase() === user.toString().trim().toLowerCase() && !isCorrect) {
        btn.classList.add('wrong');
      }
    });

    if(isCorrect) {
      score++;
      if(difficulty < 5) difficulty++;
    } else {
      if(difficulty > 1) difficulty--;
    }
    updateScoreboard();

    // بعد ثانية، اعرض سؤال جديد بسلاسة
    setTimeout(() => {
      nextQuestion();
    }, 1000);
  }

  // تحديث عرض النتيجة
  function updateScoreboard() {
    const board = document.getElementById('scoreboard');
    board.textContent = `الدرجة: ${score} | مستوى الصعوبة: ${difficulty}`;
  }

  // ابدأ اللعبة بسؤال جديد
  function nextQuestion() {
    if(askedQuestions.size > 150) {
      askedQuestions.clear(); // إعادة التعيين لمنع النقص في الأسئلة
    }
    const q = generateQuestion(difficulty);
    displayQuestion(q);
  }

  // بدء اللعبة
  updateScoreboard();
  nextQuestion();

})();
</script>
</body>
</html>
